<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Xblocks - HTML custom elements on the basis React and X-Tag." />
    <meta name="keywords" content="xblocks, react, x-tag, custom elements, javascript, user interface" />
    <meta name="author" content="Katochimoto" />
    <link rel="icon" href="favicon.ico" />

    <title>Xblocks</title>

    <link href="/bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="/styles/dashboard.css" rel="stylesheet" />
    <link href="/styles/bs-docs-sidebar.css" rel="stylesheet" />
    <link href="/styles/github.css" rel="stylesheet" />

    <style type="text/css">
        .hljs {
            padding: 0;
            background: transparent;
        }
    </style>

    <script src="/bower_components/jquery/dist/jquery.min.js"></script>
    <script src="/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="/node_modules/yate/lib/runtime.js"></script>
    <script src="/bower_components/director/build/director.min.js"></script>
    <script src="/scripts/highlight.pack.js"></script>

    <script src="/docs/docs.js"></script>
    <script>
        hljs.configure({
            tabReplace: '    '
        });

        hljs.initHighlighting();
    </script>
</head>
<body>
    <div id="app"></div>
<script>
var data = {
    'version': '0.6.0',
    'navbar': {},
    'menu': {
        'items': [
            {
                'hash': 'getting-started',
                'title': 'Getting Started',
                'menu': {
                    'items': [
                        {
                            'hash': 'getting-started/quickstart',
                            'title': 'Quick Start'
                        },
                        {
                            'hash': 'getting-started/download',
                            'title': 'Download'
                        }
                    ]
                }
            },

            {
                'hash': 'examples',
                'title': 'Examples'
            },

            {
                'hash': 'controls',
                'title': 'Controls'
            },

            {
                'hash': 'extensions',
                'title': 'Extensions',
                'menu': {
                    'items': [
                        {
                            'hash': 'extensions/writing-extensions',
                            'title': 'Writing an Extension'
                        }
                    ]
                }
            }
        ]
    }
};
</script>
<script>
var loadModule = (function() {
    var _loadModules = {};

    return function (module) {
        var dfd = $.Deferred();

        if (_loadModules.hasOwnProperty(module)) {
            if (_loadModules[ module ]) {
                dfd.resolve();

            } else {
                dfd.reject();
            }

        } else {
            $.getScript('/docs/' + module + '.js').then(function() {
                _loadModules[ module ] = true;
                dfd.resolve();

            }, function() {
                _loadModules[ module ] = false;
                dfd.reject();
            });
        }

        return dfd.promise();
    };
}());
</script>
<script>
$(function() {
    var currentModule;
    var app = document.getElementById('app');
    var router = Router({
        '/:module': {
            'on': run,

            '/:section': {
                'on': run
            }
        }
    });

    router.configure({
        'async': true,
        'notfound': function() {
            runDefault();
        },
        'after': function(next) {
            next();
        }
    });

    router.init();

    function run(module, section) {
        var next = arguments[ arguments.length - 1 ];

        if (currentModule === module) {
            setActiveMenu(module, section);
            next();
            return;
        }

        currentModule = module;

        loadModule(module).done(function() {
            app.innerHTML = yr.run(module, data);

            setActiveMenu(module, section);
            $('.highlight code').each(highlightIterate);
        })
        .fail(runDefault)
        .always(next);
    }

    function runDefault() {
        run('getting-started');
    }

    function setActiveMenu(module, section) {
        var hash = module;

        if (typeof(section) === 'string') {
            hash += '/' + section;
        }

        var scrollNode = $('.anchor[data-hash="' + hash + '"]');
        if (scrollNode.length) {
            var scrollTop = scrollNode.offset().top - 70;
            $('body').animate({ 'scrollTop': scrollTop });
        }

        $('.sidebar')
            .find('li')
            .removeClass('active')
            .end()
            .find('li[data-hash="' + module + '"]')
            .addClass('active')
            .end()
            .find('li[data-hash="' + hash + '"]')
            .addClass('active');
    }

    function highlightIterate(i, block) {
        hljs.highlightBlock(block);
    }
});
</script>
</body>
</html>
